<%
  legend_text = t("helpers.legend.events_steps_further_details.privacy_policy.text", 
    link: link_to(t("helpers.legend.events_steps_further_details.privacy_policy.link"), 
    privacy_policy_path(id: f.object.latest_privacy_policy.id), { target: :blank }))
%>

<%= f.govuk_check_boxes_fieldset :privacy_policy, legend: { text: legend_text.html_safe } do %>
  <%= f.hidden_field :privacy_policy, value: false %>
  <%= f.govuk_check_box :privacy_policy, true,
        multiple: false, link_errors: true,
        label: { text: "Yes" } %>
<% end %>

<% unless f.object.already_subscribed_to_events? %>
<%= f.govuk_collection_radio_buttons :future_events,
      f.object.subscribe_options, :last, :first,
      inline: true %>
<% end %>

<% unless f.object.already_subscribed_to_mailing_list? %>
  <%= f.govuk_radio_buttons_fieldset :mailing_list do %>
    <%= f.govuk_radio_button :mailing_list, true, label: { text: 'Yes' }, link_errors: true do %>
      <%= f.govuk_text_field :address_postcode %>
    <% end %>
    <%= f.govuk_radio_button :mailing_list, false, label: { text: 'No' } %>
  <% end %>
<% end %>

<%= f.hidden_field :event_id, value: @event.id %>
<%= f.hidden_field :accepted_policy_id, value: f.object.latest_privacy_policy.id %>
